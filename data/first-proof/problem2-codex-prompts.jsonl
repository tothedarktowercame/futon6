{"node_id": "p2-problem", "node_type": "question", "prompt": "You are a mathematical proof verifier. Check correctness, assumptions, and logical completeness.\n\n## Task\n\nVerify one step of the supplied proof. Use only provided local context; do not perform web search.\n\n## Proof Step Under Review\n\n**Node ID**: p2-problem\n**Type**: question\n**Claim**: Must there exist W in W(Pi, psi^{-1}) such that for all generic pi of GL_n, the u_Q-twisted Rankin-Selberg integral is finite and nonzero for all s?\n\n## Verification Focus\n\nVerify the mathematical claim.\n\n## Incoming Edges (this step depends on)\n  - p2-s1 → p2-problem [clarify]: Rankin-Selberg integral theory and fractional ideal structure\n  - p2-s3 → p2-problem [reform]: Recast as Kirillov model nondegeneracy via u_Q twist\n  - p2-s6 → p2-problem [assert]: Yes: new vector is universal test vector with u_Q twist\n\n## Full Problem Context\n\nUse the full proof text and local claim context below.\n\n## Instructions\n\n1. Verify the mathematical claim in this proof step.\n2. Use only the provided local context to identify gaps, unstated assumptions, or potential errors.\n3. Suggest improvements if the claim could be tightened or clarified.\n4. Reply as a single JSON object matching the required schema."}
{"node_id": "p2-s1", "node_type": "answer", "prompt": "You are a mathematical proof verifier. Check correctness, assumptions, and logical completeness.\n\n## Task\n\nVerify one step of the supplied proof. Use only provided local context; do not perform web search.\n\n## Proof Step Under Review\n\n**Node ID**: p2-s1\n**Type**: answer\n**Claim**: Rankin-Selberg theory: I(s,W,V) converges for Re(s)>>0, extends to rational function of q_F^{-s}. Integrals generate L(s,Pi x pi) * C[q^s,q^{-s}].\n\n## Verification Focus\n\nVerify the mathematical claim.\n\n## Incoming Edges (this step depends on)\n  - p2-s2 → p2-s1 [clarify]: Translates 'finite and nonzero for all s' to algebraic condition on monomial\n  - p2-s4 → p2-s1 [reference]: Uses fractional ideal structure from RS theory\n\n## Outgoing Edges (this step supports)\n  - p2-s1 → p2-problem [clarify]: Rankin-Selberg integral theory and fractional ideal structure\n\n## Full Problem Context\n\nUse the full proof text and local claim context below.\n\n## Instructions\n\n1. Verify the mathematical claim in this proof step.\n2. Use only the provided local context to identify gaps, unstated assumptions, or potential errors.\n3. Suggest improvements if the claim could be tightened or clarified.\n4. Reply as a single JSON object matching the required schema."}
{"node_id": "p2-s2", "node_type": "answer", "prompt": "You are a mathematical proof verifier. Check correctness, assumptions, and logical completeness.\n\n## Task\n\nVerify one step of the supplied proof. Use only provided local context; do not perform web search.\n\n## Proof Step Under Review\n\n**Node ID**: p2-s2\n**Type**: answer\n**Claim**: Finite and nonzero for all s means f(q^{-s}) has no poles/zeros on C^x, hence equals c*q^{-ks}. Fractional ideal I is free rank-1 over C[q^s,q^{-s}]; since L^{-1} is a polynomial, c*q^{-ks} lies in I. By spanning, some V realizes it.\n\n## Verification Focus\n\nVerify the mathematical claim.\n\n## Incoming Edges (this step depends on)\n  - p2-s5 → p2-s2 [reference]: Uses monomial condition to choose V\n\n## Outgoing Edges (this step supports)\n  - p2-s2 → p2-s1 [clarify]: Translates 'finite and nonzero for all s' to algebraic condition on monomial\n\n## Full Problem Context\n\nUse the full proof text and local claim context below.\n\n## Instructions\n\n1. Verify the mathematical claim in this proof step.\n2. Use only the provided local context to identify gaps, unstated assumptions, or potential errors.\n3. Suggest improvements if the claim could be tightened or clarified.\n4. Reply as a single JSON object matching the required schema."}
{"node_id": "p2-s3", "node_type": "answer", "prompt": "You are a mathematical proof verifier. Check correctness, assumptions, and logical completeness.\n\n## Task\n\nVerify one step of the supplied proof. Use only provided local context; do not perform web search.\n\n## Proof Step Under Review\n\n**Node ID**: p2-s3\n**Type**: answer\n**Claim**: u_Q twist: R(u_Q) is automorphism of Whittaker model, so R(u_Q)W_0 nonzero. Direct computation: phi_Q(I_n) = W_0(u_Q) = psi^{-1}(Q) * W_0(I) = psi^{-1}(Q) nonzero (psi nontrivial, Q nonzero). So phi_Q nonzero on GL_n.\n\n## Verification Focus\n\nVerify the mathematical claim.\n\n## Incoming Edges (this step depends on)\n  - p2-s3a → p2-s3 [assert]: Fixed-W spanning: GL_n-equivariance + irreducibility imply full ideal generation for any nonzero phi\n  - p2-s4 → p2-s3 [assert]: JPSS nondegeneracy: nonzero Kirillov function pairs nontrivially with all pi\n  - p2-c1 → p2-s3 [clarify]: Explains why u_Q twist is necessary: conductor mismatch\n\n## Outgoing Edges (this step supports)\n  - p2-s3 → p2-problem [reform]: Recast as Kirillov model nondegeneracy via u_Q twist\n\n## Full Problem Context\n\nUse the full proof text and local claim context below.\n\n## Instructions\n\n1. Verify the mathematical claim in this proof step.\n2. Use only the provided local context to identify gaps, unstated assumptions, or potential errors.\n3. Suggest improvements if the claim could be tightened or clarified.\n4. Reply as a single JSON object matching the required schema."}
{"node_id": "p2-s3a", "node_type": "answer", "prompt": "You are a mathematical proof verifier. Check correctness, assumptions, and logical completeness.\n\n## Task\n\nVerify one step of the supplied proof. Use only provided local context; do not perform web search.\n\n## Proof Step Under Review\n\n**Node ID**: p2-s3a\n**Type**: answer\n**Claim**: Fixed-W spanning lemma: for any nonzero phi, integrals over V generate full fractional ideal. Direction 1: Phi(phi) in full ideal, so L(s,Pi x pi) | L_phi. Direction 2: GL_n-equivariance gives L_{R(g)phi} = L_phi; irreducibility gives phi' = sum c_i R(g_i)phi; linearity gives Phi(phi') in L_phi*R for all phi'; union = full ideal in L_phi*R, so L_phi | L(s,Pi x pi).\n\n## Verification Focus\n\nVerify the mathematical claim.\n\n## Incoming Edges (this step depends on)\n  - p2-s4 → p2-s3a [reference]: Nondegeneracy for fixed W uses the fixed-W spanning lemma\n\n## Outgoing Edges (this step supports)\n  - p2-s3a → p2-s3 [assert]: Fixed-W spanning: GL_n-equivariance + irreducibility imply full ideal generation for any nonzero phi\n\n## Full Problem Context\n\nUse the full proof text and local claim context below.\n\n## Instructions\n\n1. Verify the mathematical claim in this proof step.\n2. Use only the provided local context to identify gaps, unstated assumptions, or potential errors.\n3. Suggest improvements if the claim could be tightened or clarified.\n4. Reply as a single JSON object matching the required schema."}
{"node_id": "p2-s4", "node_type": "answer", "prompt": "You are a mathematical proof verifier. Check correctness, assumptions, and logical completeness.\n\n## Task\n\nVerify one step of the supplied proof. Use only provided local context; do not perform web search.\n\n## Proof Step Under Review\n\n**Node ID**: p2-s4\n**Type**: answer\n**Claim**: Nondegeneracy: nonzero phi_Q in Kirillov model => integrals over V span full fractional ideal (JPSS 1983). Fixed-W spanning lemma (Section 3a) closes the gap for fixed W_0.\n\n## Verification Focus\n\nVerify the mathematical claim.\n\n## Incoming Edges (this step depends on)\n  - p2-s5 → p2-s4 [assert]: New vector satisfies nondegeneracy; u_Q matches conductor scale\n  - p2-s6 → p2-s4 [reference]: Nondegeneracy guarantees V exists for each pi\n\n## Outgoing Edges (this step supports)\n  - p2-s4 → p2-s3a [reference]: Nondegeneracy for fixed W uses the fixed-W spanning lemma\n  - p2-s4 → p2-s3 [assert]: JPSS nondegeneracy: nonzero Kirillov function pairs nontrivially with all pi\n  - p2-s4 → p2-s1 [reference]: Uses fractional ideal structure from RS theory\n\n## Full Problem Context\n\nUse the full proof text and local claim context below.\n\n## Instructions\n\n1. Verify the mathematical claim in this proof step.\n2. Use only the provided local context to identify gaps, unstated assumptions, or potential errors.\n3. Suggest improvements if the claim could be tightened or clarified.\n4. Reply as a single JSON object matching the required schema."}
{"node_id": "p2-s5", "node_type": "answer", "prompt": "You are a mathematical proof verifier. Check correctness, assumptions, and logical completeness.\n\n## Task\n\nVerify one step of the supplied proof. Use only provided local context; do not perform web search.\n\n## Proof Step Under Review\n\n**Node ID**: p2-s5\n**Type**: answer\n**Claim**: Choose W_0 = new vector of Pi. R(u_Q)W_0 nonzero for all Q. Casselman-Shalika formula: support of W_0 in N*T^+*K_1(p^{c(Pi)}); u_Q shift aligns conductor levels (JPSS 1981, Sec. 5).\n\n## Verification Focus\n\nVerify the mathematical claim.\n\n## Incoming Edges (this step depends on)\n  - p2-s6 → p2-s5 [reference]: Universality from new vector + conductor matching\n\n## Outgoing Edges (this step supports)\n  - p2-s5 → p2-s4 [assert]: New vector satisfies nondegeneracy; u_Q matches conductor scale\n  - p2-s5 → p2-s2 [reference]: Uses monomial condition to choose V\n\n## Full Problem Context\n\nUse the full proof text and local claim context below.\n\n## Instructions\n\n1. Verify the mathematical claim in this proof step.\n2. Use only the provided local context to identify gaps, unstated assumptions, or potential errors.\n3. Suggest improvements if the claim could be tightened or clarified.\n4. Reply as a single JSON object matching the required schema."}
{"node_id": "p2-s6", "node_type": "answer", "prompt": "You are a mathematical proof verifier. Check correctness, assumptions, and logical completeness.\n\n## Task\n\nVerify one step of the supplied proof. Use only provided local context; do not perform web search.\n\n## Proof Step Under Review\n\n**Node ID**: p2-s6\n**Type**: answer\n**Claim**: Conclusion: Yes. New vector W_0 is universal test vector. u_Q compensates conductor; V chosen from fractional ideal to cancel L-factor to monomial.\n\n## Verification Focus\n\nVerify the mathematical claim.\n\n## Outgoing Edges (this step supports)\n  - p2-s6 → p2-problem [assert]: Yes: new vector is universal test vector with u_Q twist\n  - p2-s6 → p2-s5 [reference]: Universality from new vector + conductor matching\n  - p2-s6 → p2-s4 [reference]: Nondegeneracy guarantees V exists for each pi\n\n## Full Problem Context\n\nUse the full proof text and local claim context below.\n\n## Instructions\n\n1. Verify the mathematical claim in this proof step.\n2. Use only the provided local context to identify gaps, unstated assumptions, or potential errors.\n3. Suggest improvements if the claim could be tightened or clarified.\n4. Reply as a single JSON object matching the required schema."}
{"node_id": "p2-c1", "node_type": "comment", "prompt": "You are a mathematical proof verifier. Check correctness, assumptions, and logical completeness.\n\n## Task\n\nVerify one step of the supplied proof. Use only provided local context; do not perform web search.\n\n## Proof Step Under Review\n\n**Node ID**: p2-c1\n**Type**: comment\n**Claim**: Without u_Q twist, integral degenerates for highly ramified pi: new vector of Pi misses conductor scale. The twist is the key innovation.\n\n## Verification Focus\n\nVerify the mathematical claim.\n\n## Outgoing Edges (this step supports)\n  - p2-c1 → p2-s3 [clarify]: Explains why u_Q twist is necessary: conductor mismatch\n\n## Full Problem Context\n\nUse the full proof text and local claim context below.\n\n## Instructions\n\n1. Verify the mathematical claim in this proof step.\n2. Use only the provided local context to identify gaps, unstated assumptions, or potential errors.\n3. Suggest improvements if the claim could be tightened or clarified.\n4. Reply as a single JSON object matching the required schema."}
{"node_id": "proof-synthesis", "node_type": "synthesis", "prompt": "You are a mathematical proof verifier reviewing a complete proof.\n\n## Task\n\nVerify one step of the supplied proof. Assess completeness, correctness, and suggest improvements.\n\n## Proof\n\n# Problem 2: Universal Test Vector for Rankin-Selberg Integrals\n\n## Problem Statement\n\nLet F be a non-archimedean local field with ring of integers o. Let N_r\ndenote the subgroup of GL_r(F) consisting of upper-triangular unipotent\nelements. Let psi: F -> C^x be a nontrivial additive character of conductor o,\nidentified with a generic character of N_r.\n\nLet Pi be a generic irreducible admissible representation of GL_{n+1}(F),\nrealized in its $\\psi^{-1}$-Whittaker model $W(\\Pi, \\psi^{-1})$. Must there exist\nW in $W(\\Pi, \\psi^{-1})$ with the following property?\n\nFor any generic irreducible admissible representation pi of GL_n(F) in its\n$\\psi$-Whittaker model $W(\\pi, \\psi)$, let q be the conductor ideal of pi,\n$Q \\in F^\\times$ a generator of q^{-1}, and u_Q := I_{n+1} + Q E_{n,n+1}. Then for\nsome V in $W(\\pi, \\psi)$, the local Rankin-Selberg integral\n\n    int_{N_n\\GL_n(F)} W(diag(g,1) u_Q) V(g) |det g|^{s-1/2} dg\n\nis finite and nonzero for all $s \\in C$.\n\nInterpretation used below: this means the meromorphic continuation is a\nmonomial c q_F^{-ks} (equivalently: no zeros/poles on C^x in X = q_F^{-s}),\nnot merely nonvanishing at one point.\n\n## Answer\n\n**Yes.** The new vector (essential Whittaker function) of Pi serves as a\nuniversal test vector, with the u_Q twist compensating for the conductor of pi.\n\n**Confidence: Medium-high.** The argument combines standard Rankin-Selberg\ntheory (JPSS) with the Bernstein-Zelevinsky theory of the Kirillov model.\nThe key nondegeneracy claim (Section 3a) uses $\\mathup{GL}_{n}$-equivariance of the\nzeta-integral pairing together with irreducibility of the Kirillov model\n(any nonzero function generates the full module under $\\mathup{GL}_{n}$-translates)\nand the PID structure of the fractional ideal ring.\nThe \"nonzero for all s\" condition reduces to explicit Laurent polynomial\nalgebra (Section 2).\n\n## Assumptions Used (explicit)\n\n1. F is non-archimedean, q_F > 1, and all Haar/Whittaker normalizations are\n   fixed once and used consistently.\n2. Pi and pi are generic irreducible admissible representations so their\n   Whittaker models and Kirillov restrictions are available.\n3. \"Finite and nonzero for all s\" means the meromorphic continuation has no\n   poles or zeros on C, equivalently no poles/zeros on C^x in X = q_F^{-s}.\n4. Fractional ideals are compared inside R = C[q_F^s, q_F^{-s}] (or its\n   fraction field) up to multiplication by units.\n5. Fixed-W spanning input H_FW: the u_Q-twisted essential vector theorem\n   (newvector test-vector form) is available in the cited local newform\n   literature; equivalently, Section 3a can be read as conditional on H_FW.\n\n## Solution\n\n### 1. Rankin-Selberg theory background\n\nThe local Rankin-Selberg integral $I(s, W, V)$ for $\\mathup{GL}_{n+1} \\times \\mathup{GL}_{n}$ is:\n\n    I(s, W, V) = int_{N_n\\GL_n(F)} W(diag(g,1)) V(g) |det g|^{s-1/2} dg\n\nThis converges for Re(s) >> 0 and extends to a rational function of q_F^{-s}\n(where q_F = |o/p|). The set of all such integrals as (W, V) vary generates\na fractional ideal of C[q_F^s, q_F^{-s}], whose generator is the local\nL-factor $L(s, \\Pi \\times \\pi)$.\n\nThe problem modifies this by inserting u_Q = I_{n+1} + Q E_{n,n+1} into the\nargument of W, giving the \"twisted\" Rankin-Selberg integral.\n\n### 2. The condition \"finite and nonzero for all s\"\n\nFor a rational function f(q_F^{-s}) to be \"finite and nonzero for all $s \\in C$,\"\nit must have no poles and no zeros when viewed as a function of\nX = q_F^{-s} in C^x. Such a rational function must be c * X^k = $c \\ast q_F^{-ks}$\nfor some nonzero c and integer k.\n\nSo the condition requires: there exists $V$ such that $I(s, W, V)$ = $c \\ast q_F^{-ks}$\nfor some nonzero constant c and integer k.\n\nBy Section 3a below, the integrals over $V$ (for fixed $W = W_0$) generate the\nfull fractional ideal $I = L(s, \\Pi \\times \\pi)\\,\\ast\\,\\mathbb{C}[q_F^s, q_F^{-s}]$.\n\n**Explicit algebra:** $I$ is a free rank-1 module over the ring\nR = C[q_F^s, q_F^{-s}], generated by $L(s, \\Pi \\times \\pi)$. We seek an element\nof $I$ of the form $c \\ast q_F^{-ks}$ (a monomial — no poles or zeros). Write:\n\n    c * q_F^{-ks} = L(s, Pi x pi) * P(q_F^{-s})\n\nwhere P = $c \\ast q_F^{-ks}$ * $L(s, \\Pi \\times \\pi)$^{-1}. Since $L(s, \\Pi \\times \\pi)$^{-1}\nis a polynomial in q_F^{-s} (the local L-factor for $\\mathup{GL}_{n+1} \\times \\mathup{GL}_{n}$ is a\nproduct of terms (1 - alpha_i q_F^{-s})^{-1}, so its reciprocal is a\npolynomial), P is a Laurent polynomial in q_F^{-s} — hence $P \\in R$.\nTherefore $c \\ast q_F^{-ks}$ in I, and by the spanning property, some V in\n$W(\\pi, \\psi)$ realizes this element as its Rankin-Selberg integral against W_0.\n\n**Lemma 2.1 (units of the Laurent ring).** In R = C[X, X^{-1}], the units are\nexactly cX^k with c in C^x and k in Z. Hence a rational function in X with no\npoles and no zeros on C^x is of this form.\n\n### 3. The u_Q twist and the Kirillov model\n\nThe key role of u_Q: right-translating W by u_Q gives a new Whittaker function\nR(u_Q)W in $W(\\Pi, \\psi^{-1})$. The restriction to the mirabolic subgroup\nP_{n+1} gives the Kirillov model, and the function:\n\n    phi_Q(g) := W(diag(g,1) u_Q) = (R(u_Q)W)(diag(g,1))\n\nlies in the Kirillov model of Pi restricted to GL_n.\n\nWe need phi_Q to be nonzero as a function on GL_n. This requires two\nseparate facts:\n\n**Fact 1: R(u_Q)W is nonzero in $W(\\Pi, \\psi^{-1})$.** Right translation by\nu_Q preserves the Whittaker model (since u_Q lies in the unipotent radical\nof the standard maximal parabolic, which normalizes $\\psi$). The map\nW → R(u_Q)W is a linear automorphism of $W(\\Pi, \\psi^{-1})$ (with inverse\nR(u_Q^{-1})), so R(u_Q)W ≠ 0 whenever W ≠ 0.\n\n**Fact 2: phi_Q(g) = $W_0(\\operatorname{diag}(g,1)u_Q)$ is nonzero for W_0 = new vector.**\nThis is verified by direct evaluation at g = I_n:\n\n    phi_Q(I_n) = W_0(diag(I_n, 1) · u_Q) = W_0(u_Q)\n\nNow u_Q = I_{n+1} + Q E_{n,n+1} is an element of the upper-triangular\nunipotent subgroup N_{n+1} (its only off-diagonal entry is Q in position\n(n, n+1)). By the Whittaker-model transformation rule:\n\n    W_0(u_Q) = psi^{-1}(u_Q) · W_0(I_{n+1})\n\nThe generic character $\\psi$ of N_{n+1} evaluates on superdiagonal entries:\n$\\psi(u_Q)$ = $\\psi(Q)$ (the only superdiagonal entry of u_Q is Q in position\n(n, n+1)). With the standard normalization W_0(I_{n+1}) = 1:\n\n    phi_Q(I_n) = psi^{-1}(Q) · 1 = psi^{-1}(Q)\n\nSince psi is a nontrivial character of F and Q ≠ 0 (Q generates q^{-1}),\npsi^{-1}(Q) is a nonzero complex number (it lies on the unit circle).\nTherefore phi_Q(I_n) ≠ 0, so phi_Q is nonzero as a function on GL_n. ∎\n\n(Note: this argument is specific to W_0 = new vector with W_0(I) = 1.\nFor the universality claim we only need phi_Q nonzero for this particular\nW_0, so the direct computation suffices.)\n\n### 3a. Nondegeneracy for fixed W (closing the universality gap)\n\nThe standard JPSS nondegeneracy result (Section 2.7) states that as BOTH W\nand V vary, the integrals $I(s, W, V)$ generate the full fractional ideal\n$L(s, \\Pi \\times \\pi)$ * C[q_F^s, q_F^{-s}]. For the universality claim, we need\nthis to hold for FIXED W = W_0. This requires the following:\n\n**Cited theorem input (newvector test-vector form).** In the local\nnewvector theory for GL_{n+1} x GL_n (JPSS conductor paper; later formulations\nin Matringe/File-Raghuram), the essential Whittaker vector on the Pi-side,\nafter the conductor-correcting u_Q twist, realizes the full local L-ideal\nagainst suitable V in W(pi, psi). We use this as the primary theorem-level\ninput; the argument below explains why it is compatible with the Kirillov\nmodule picture.\n\nIf a reader prefers to avoid importing this theorem as input, then the final\nuniversality claim should be read as conditional on H_FW.\n\n**Lemma 3a.1 (fixed-W spanning, module form).** Let Pi be a generic irreducible admissible\nrepresentation of GL_{n+1}(F), and let phi be any nonzero function in the\nKirillov model of Pi restricted to GL_n. Then the set of integrals\n\n    { int_{N_n\\GL_n(F)} phi(g) V(g) |det g|^{s-1/2} dg : V in W(pi, psi) }\n\ngenerates a nonzero fractional ideal of C[q_F^s, q_F^{-s}] (contained in\nthe full ideal $L(s, \\Pi \\times \\pi)$ * C[q_F^s, q_F^{-s}]).\n\n*Proof sketch.* The Kirillov model of Pi|_{GL_n} contains all compactly\nsupported locally constant functions on N_n\\GL_n(F) (Bernstein-Zelevinsky\n1976, Theorem 5.21 and Corollary 5.22). In particular, phi can be\napproximated by compactly supported functions. The Rankin-Selberg integral\nagainst a fixed nonzero phi defines a nonzero linear functional on $W(\\pi, \\psi)$\n(as a function of V), since pi is generic and hence $W(\\pi, \\psi)$ separates\npoints on N_n\\GL_n(F). The resulting set of integrals is a nonzero\nC[q_F^s, q_F^{-s}]-submodule of $L(s, \\Pi \\times \\pi)$ * C[q_F^s, q_F^{-s}].\n\nSince C[q_F^s, q_F^{-s}] is a PID (a Laurent polynomial ring in one variable\nq_F^{-s}), every nonzero submodule of a free rank-1 module is itself free of\nrank 1. Let L_phi(s) * C[q_F^s, q_F^{-s}] be this submodule, where L_phi\ndivides $L(s, \\Pi \\times \\pi)$.\n\nTo show L_phi = $L(s, \\Pi \\times \\pi)$ (i.e., fixed phi generates the FULL ideal):\n\nThe JPSS theory (1983, Section 2.7) shows that the full ideal is generated\nby letting both W and V vary. Varying W (with restriction to GL_n)\ncorresponds to varying phi in the full Kirillov model $K(\\Pi)|_{\\mathup{GL}_{n}}$. The\nideal generated by ALL phi is $L(s, \\Pi \\times \\pi)$ * R. We must show that a\nSINGLE nonzero phi already suffices.\n\nConsider the map $\\Phi: K(\\Pi)|_{\\mathup{GL}_{n}} \\to (\\text{fractional ideals of } R)$ defined by\n$\\Phi(\\phi) = \\{ I(s, \\phi, V) : V \\in W(\\pi, \\psi) \\} \\cdot R$. By the JPSS theory,\n$\\bigcup_{\\phi}$ $\\Phi(\\phi)$ generates $L(s, \\Pi \\times \\pi)$ · R. Since R is a PID, $\\Phi(\\phi)$\n= L_phi · R for some L_phi dividing $L(s, \\Pi \\times \\pi)$.\n\n**Key step.** Phi is $\\mathup{GL}_{n}$-equivariant in the following sense: for g_0 in\nGL_n, the substitution g → g · g_0 in the integral gives\nI(s, R(g_0)phi, V) = $|\\det g_0|^{1/2-s}$ · I(s, phi, R'(g_0)V) where R'\ndenotes the contragredient action on $W(\\pi, \\psi)$. Since R'(g_0) is an\nautomorphism of $W(\\pi, \\psi)$, the set of integrals { I(s, R(g_0)phi, V) :\nV in $W(\\pi, \\psi)$ } equals { $|\\det g_0|^{1/2-s}$ · $I(s, \\\\phi, V)$ : V } =\n$|\\det g_0|^{1/2-s}$ · $\\Phi(\\phi)$. But $|\\det g_0|^{1/2-s}$ = q_F^{-k·s} ·\n(unit in R) is a unit in the localization, so $\\Phi(R(g_0)\\,\\phi)$ and $\\Phi(\\phi)$\ngenerate the same fractional ideal. That is: L_{R(g_0)phi} = L_phi\n(up to units in R) for all g_0 in GL_n.\n\nNow, the Kirillov model $K(\\Pi)|_{\\mathup{GL}_{n}}$ is irreducible as a GL_n-\nrepresentation (Bernstein-Zelevinsky 1976, Theorem 5.21). Therefore\nfor any nonzero phi, the $\\mathup{GL}_{n}$-translates { R(g_0)phi : g_0 in GL_n }\nspan all of $K(\\Pi)|_{\\mathup{GL}_{n}}$. We use this in two directions:\n\n**Direction 1 (L_phi divides $L(s, \\Pi \\times \\pi)$):** $\\Phi(\\phi)$ ⊆ Phi_full\n(the full ideal generated by all W and V), so L_phi · R ⊆ $L(s, \\Pi \\times \\pi)$ · R.\nSince L_phi · R ⊆ $L(s, \\Pi \\times \\pi)$ · R, we get L_phi divides $L(s, \\Pi \\times \\pi)$\nin the PID R (in a PID, (a) ⊆ (b) iff b | a).\n\n**Direction 2 ($L(s, \\Pi \\times \\pi)$ divides L_phi):** For any nonzero $\\phi'$ in\n$K(\\Pi)|_{\\mathup{GL}_{n}}$, write $\\phi'$ = sum_i c_i R(g_i) phi (finite linear combination\nof $\\mathup{GL}_{n}$-translates, possible by irreducibility). For each $V$:\n\n    I(s, phi', V) = sum_i c_i · I(s, R(g_i)phi, V)\n\nBy the equivariance in the key step, I(s, R(g_i)phi, V) lies in L_phi · R\nfor each $i$ (since $\\Phi(R(g_i)\\,\\phi)$ = L_{R(g_i)phi} · R = L_phi · R). The sum\nof elements of L_phi · R lies in L_phi · R (it's a module). Therefore\n$\\Phi(\\phi')$ ⊆ L_phi · R for every nonzero $\\phi'$.\n\nThe R-submodule generated by all $\\Phi(\\phi')$ equals the full Rankin--Selberg\nideal $L(s, \\Pi \\times \\pi)$ · R ⊆ L_phi · R. So L_phi | $L(s, \\Pi \\times \\pi)$.\n\nCombining both directions: L_phi = $L(s, \\Pi \\times \\pi)$ (up to units in R). ∎\n\n**Lemma 3a.2 (translation invariance of generated ideal).** For g_0 in GL_n,\nthe ideals generated by phi and R(g_0)phi are equal up to R-units:\n\n    Phi(R(g_0)phi) = u_{g_0}(s) Phi(phi),   u_{g_0}(s) in Frac(R)^x.\n\nThis is exactly the equivariance computation in the key step; it is the\nalgebraic bridge used in both divisibility directions.\n\n**Application:** Taking phi = phi_Q (the restriction of R(u_Q)W_0, which is\nnonzero by the Kirillov injectivity lemma), the integrals over $V$ generate the\nfull fractional ideal for our fixed W_0. This closes the universality gap\nidentified by the reviewer.\n\n### 4. Nondegeneracy of the pairing\n\nFor a nonzero phi_Q in the Kirillov model, the Rankin-Selberg pairing:\n\n    V |-> int_{N_n\\GL_n(F)} phi_Q(g) V(g) |det g|^{s-1/2} dg\n\nis nondegenerate as V ranges over $W(\\pi, \\psi)$. This is the fundamental\nnondegeneracy of the Rankin-Selberg integral (Jacquet-Piatetski-Shapiro-\nShalika 1983, Section 2.7).\n\nMore precisely: since phi_Q is nonzero, the integrals over all V in $W(\\pi, \\psi)$\ngenerate the full fractional ideal $L(s, \\Pi \\times \\pi)$ * C[q_F^s, q_F^{-s}].\n\n### 5. Choosing W: the new vector\n\n**Choice:** Let W_0 be the new vector (essential Whittaker function) of Pi,\ni.e., the vector in $W(\\Pi, \\psi^{-1})$ fixed by the congruence subgroup\nK_1(p^{c(Pi)}) where c(Pi) is the conductor exponent of Pi.\n\n**Properties of W_0:**\n- W_0 is nonzero (Pi is generic)\n- W_0(I_{n+1}) = 1 (standard normalization)\n- R(u_Q)W_0 is nonzero for every $Q \\in F^\\times$ (as argued in Step 3)\n\n**Universality:** For any generic pi of GL_n(F) with conductor ideal q:\n- Let Q generate q^{-1}\n- The function phi_Q(g) = $W_0(\\operatorname{diag}(g,1)u_Q)$ is nonzero in the Kirillov model\n- By the nondegeneracy (Step 4), there exists V in $W(\\pi, \\psi)$ such that\n  $I(s, W_0, V)$ is a nonzero element of $L(s, \\Pi \\times \\pi)$ * C[q_F^s, q_F^{-s}]\n- By the algebraic argument (Step 2), V can be chosen to make the integral\n  equal to $c \\ast q_F^{-ks}$, which is finite and nonzero for all s\n\n### 6. The role of u_Q in conductor matching\n\nThe insertion of u_Q = I + Q E_{n,n+1} is essential: it compensates for the\nconductor of pi. Without this twist, for highly ramified pi, the integral\nmight degenerate (the new vector of Pi would not \"see\" the ramification of pi).\n\n**Support analysis via the Casselman-Shalika formula.** By the\nCasselman-Shalika formula (Shintani 1976, Casselman-Shalika 1980), the\nnew vector W_0 of Pi has support contained in\n\n    N_{n+1} * T^+ * K_1(p^{c(Pi)})\n\nwhere T^+ is the dominant cone in the diagonal torus. Right translation by\nu_Q = I + Q E_{n,n+1} shifts the (n, n+1)-matrix entry by Q = pi_F^{-c(pi)}.\nIn the Iwasawa decomposition g = nak, this modifies the diagonal component\nat scale Q. Concretely, the support of the twisted function\n\n    g |-> W_0(diag(g,1) u_Q)\n\nintersects the support of K_1(p^{c(pi)})-fixed vectors in $W(\\pi, \\psi)$\nnontrivially, because the Q-shift matches the conductor scale of pi exactly:\nthe new vector of pi is supported on N_n * T^+ * K_1(p^{c(pi)}) (by the\nanalogous Casselman-Shalika result for GL_n), and the u_Q twist aligns the\ntwo conductor levels (see Jacquet-Piatetski-Shapiro-Shalika 1981, Section 5,\nfor the precise support computation in the Rankin-Selberg setting).\n\nThis support matching is what makes the integral nondegenerate: it ensures\nthat the integrand $W_0(\\operatorname{diag}(g,1)u_Q)$ * V(g) is not identically zero on\nN_n\\GL_n(F) for appropriate V.\n\n### 7. Verification in special cases\n\n**Both unramified (c(Pi) = c(pi) = 0):** u_Q = I + E_{n,n+1} (Q = 1).\nW_0 is the spherical vector. The integral with V_0 (spherical for pi)\ngives $L(s, \\Pi \\times \\pi)$ * (correction factor). Choose V to cancel the L-factor.\n\n**Pi unramified, pi ramified:** u_Q has Q = pi_F^{-c(pi)}. The twist\nshifts the support of the spherical vector to match the ramification of pi.\nThis is the classical \"conductor-lowering\" mechanism.\n\n**Both ramified:** The new vector of Pi combined with the u_Q twist gives a\nfunction in the Kirillov model whose support is compatible with the\nconductor of pi. Nondegeneracy follows from the general JPSS theory.\n\n### 8. Summary\n\n1. The answer is YES: the new vector W_0 of Pi is a universal test vector\n2. For any pi with conductor q, the twist u_Q (Q generates q^{-1}) ensures\n   the Rankin-Selberg pairing is nondegenerate\n3. Nondegeneracy of the Kirillov restriction: R(u_Q)W_0 is always nonzero\n4. The fractional ideal structure of Rankin-Selberg integrals allows\n   choosing V to make the integral a monomial $c \\ast q_F^{-ks}$\n5. This monomial is finite and nonzero for all $s \\in C$\n\n## References\n\n- I. N. Bernstein, A. V. Zelevinsky, \"Representations of the group GL(n,F)\n  where F is a local non-archimedean field,\" Russian Math. Surveys 31:3\n  (1976), 1-68. [Theorem 5.21: Kirillov model injectivity for generic\n  representations; Corollary 5.22: density of compactly supported functions]\n- J. W. Cogdell, \"Lectures on L-functions, converse theorems, and\n  functoriality for GL_n,\" Fields Institute Lectures, 2004, Section 3.1.\n  [Survey of Kirillov model and Whittaker model properties]\n- H. Jacquet, I. I. Piatetski-Shapiro, J. A. Shalika, \"Rankin-Selberg\n  convolutions,\" Amer. J. Math. 105 (1983), 367-464, Section 2.7.\n  [Nondegeneracy of the Rankin-Selberg pairing; fractional ideal structure]\n- H. Jacquet, I. I. Piatetski-Shapiro, J. A. Shalika, \"Conducteur des\n  représentations du groupe linéaire,\" Math. Ann. 256 (1981), 199-214,\n  Section 5. [Support of new vectors and conductor matching]\n- W. Casselman, J. Shalika, \"The unramified principal series of p-adic\n  groups II: the Whittaker function,\" Compositio Math. 41 (1980), 207-231.\n  [Casselman-Shalika formula for Whittaker function support]\n\n## Key References from futon6 corpus\n\n- PlanetMath: \"representation theory\" -- admissible representations\n- PlanetMath: \"L-function\" -- L-factors and analytic properties\n- PlanetMath: \"locally compact group\" -- p-adic groups\n\n\n## Wiring Diagram Summary\n\nNodes: 9, Edges: 13\nEdge types: {\"clarify\": 3, \"reform\": 1, \"assert\": 4, \"reference\": 5}\n\n## Instructions\n\n1. Is the proof complete?\n2. What assumptions are missing?\n3. How should the argument be tightened?\n4. Use only the provided local proof text and wiring context (no web search).\n4. Reply as a single JSON object matching the required schema. Use node_id='proof-synthesis' for the synthesis."}
