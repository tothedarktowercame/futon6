======================================================================
Problem 4: Scaling analysis of minimum surplus
======================================================================

--- Adversarial minimum vs n ---
   n        min_ratio          surplus   spread_p   spread_q  scale_ratio   gap_cv_p   gap_cv_q
   3   1.000000000000        -1.01e-14     1.4836     3.9168       2.6402     0.0000     0.0000
   4   1.000000000000        -6.99e-15     6.9193     6.1250       1.1297     0.0329     0.0329
   5   1.000000000000        -1.42e-14     2.7341     4.8877       1.7877     0.0510     0.0510
   6   1.000000000000        -1.42e-14     9.4231     2.0588       4.5769     0.0656     0.0656
   7   1.000000000000        -5.88e-15     6.9649     4.4497       1.5653     0.0779     0.0779
   8   1.000000000000        -2.00e-15     9.9127     9.4913       1.0444     0.0885     0.0885

--- Scale separation: how tight can we get? ---
   n        min_ratio   best_scale
   4   0.999999999944    7096.9771
   5   0.999999999909    2948.6040
   6   0.999999999911    8748.7142
   7   0.999999985941    5163.9250
   8   0.999999980702    2687.1889

--- Random sampling percentiles vs n ---
   n       p0 (min)         p1         p5        p25        p50  valid
   3     1.00000924     1.0015     1.0208     1.1540     1.5108   1500
   4     1.00107205     1.0446     1.1487     1.5465     2.2558   1500
   5     1.03320960     1.1366     1.3755     2.1133     3.4084   1500
   6     1.15705617     1.2826     1.5738     2.5305     4.2764   1500
   7     1.23151265     1.4644     1.9118     3.1521     5.2935   1500
   8     1.29081774     1.5741     2.0744     3.6463     6.7072   1500
  10     1.66941386     2.0369     2.6974     4.9440     9.6061    600
  12     2.11200621     2.5494     3.3305     5.9165    10.9854    600
  15     2.43703369     3.4460     4.3620     8.3782    14.0423    600

--- Structure of adversarial tight cases ---

  n=3: ratio = 1.000000000000
    roots_p: [1.98071098 2.72248608 3.46426117]
    roots_q: [-0.94850381  1.00989825  2.96830041]
    spread_p=1.4836  spread_q=3.9168  scale_ratio=2.6402
    gap_cv_p=0.0000  gap_cv_q=0.0000
    gaps_p: [0.7417751  0.74177509]
    gaps_q: [1.95840206 1.95840216]
    gaps_p uniform? cv=0.0000
    gaps_q uniform? cv=0.0000

  n=4: ratio = 1.000000000000
    roots_p: [-0.02341305  2.33662262  4.53582574  6.89586138]
    roots_q: [-1.77067284  0.31846581  2.26523314  4.35437177]
    spread_p=6.9193  spread_q=6.1250  scale_ratio=1.1297
    gap_cv_p=0.0329  gap_cv_q=0.0329
    gaps_p: [2.36003568 2.19920312 2.36003564]
    gaps_q: [2.08913864 1.94676734 2.08913862]
    gaps_p uniform? cv=0.0329
    gaps_q uniform? cv=0.0329

  n=5: ratio = 1.000000000000
    roots_p: [1.66157345 2.37995506 3.02861182 3.67726859 4.39565016]
    roots_q: [-1.87625738 -0.59200955  0.56759151  1.72719259  3.01144033]
    spread_p=2.7341  spread_q=4.8877  scale_ratio=1.7877
    gap_cv_p=0.0510  gap_cv_q=0.0510
    gaps_p: [0.71838162 0.64865676 0.64865677 0.71838157]
    gaps_q: [1.28424783 1.15960106 1.15960108 1.28424775]
    gaps_p uniform? cv=0.0510
    gaps_q uniform? cv=0.0510

  n=6: ratio = 1.000000000000
    roots_p: [-10.05206294  -8.01809735  -6.214605    -4.46646733  -2.66297494
  -0.6290094 ]
    roots_q: [-0.46376011 -0.01936204  0.37468036  0.75662835  1.15067072  1.59506892]
    spread_p=9.4231  spread_q=2.0588  scale_ratio=4.5769
    gap_cv_p=0.0656  gap_cv_q=0.0656
    gaps_p: [2.03396559 1.80349235 1.74813767 1.80349239 2.03396554]
    gaps_q: [0.44439807 0.3940424  0.38194799 0.39404238 0.4443982 ]
    gaps_p uniform? cv=0.0656
    gaps_q uniform? cv=0.0656

  n=7: ratio = 1.000000000000
    roots_p: [-3.06845434 -1.78364351 -0.65791705  0.41400146  1.48591997  2.61164642
  3.89645715]
    roots_q: [0.06315689 0.88398574 1.60318017 2.28799823 2.97281624 3.69201072
 4.51283959]
    spread_p=6.9649  spread_q=4.4497  scale_ratio=1.5653
    gap_cv_p=0.0779  gap_cv_q=0.0779
    gaps_p: [1.28481083 1.12572646 1.07191851 1.0719185  1.12572646 1.28481072]
    gaps_q: [0.82082885 0.71919443 0.68481806 0.68481801 0.71919448 0.82082887]
    gaps_p uniform? cv=0.0779
    gaps_q uniform? cv=0.0779

  n=8: ratio = 1.000000000000
    roots_p: [-5.77014786 -4.16520927 -2.77085773 -1.45845665 -0.16911166  1.1432894
  2.53764093  4.14257953]
    roots_q: [-4.95127605 -3.41457202 -2.07950191 -0.82289815  0.41162982  1.66823358
  3.00330372  4.54000777]
    spread_p=9.9127  spread_q=9.4913  scale_ratio=1.0444
    gap_cv_p=0.0885  gap_cv_q=0.0885
    gaps_p: [1.6049386  1.39435154 1.31240108 1.289345   1.31240105 1.39435153
 1.6049386 ]
    gaps_q: [1.53670403 1.33507011 1.25660376 1.23452797 1.25660376 1.33507013
 1.53670406]
    gaps_p uniform? cv=0.0885
    gaps_q uniform? cv=0.0885
