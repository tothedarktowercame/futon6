{
  "thread_id": "first-proof-p10",
  "nodes": [
    {
      "id": "p10-problem",
      "node_type": "question",
      "post_id": 10,
      "body_text": "Given [(Z⊗K_tau)ᵀSS'(Z⊗K_tau) + λ(Iᵣ⊗K_tau)]vec(W) = (Iᵣ⊗K_tau)vec(B), with K_tau = K + τI and λ>0, explain how PCG solves this without O(N) computation.",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": null
    },
    {
      "id": "p10-s1",
      "node_type": "answer",
      "post_id": 101,
      "body_text": "Why naive direct methods fail: A is nr×nr, so dense factorization costs O(n³r³). The naive explicit route materializes (Z⊗K_tau) in ℝ^{N×nr}, costing O(Nnr), which is N-dependent and infeasible.",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": 10
    },
    {
      "id": "p10-s2",
      "node_type": "answer",
      "post_id": 102,
      "body_text": "Key insight: with λ>0 and K_tau ≻ 0, PCG only needs v ↦ A v, never A explicitly. The implicit matvec costs O(n²r + qr), independent of N.",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": 10
    },
    {
      "id": "p10-s2a",
      "node_type": "comment",
      "post_id": 1021,
      "body_text": "Forward map at observed entries: By the Kronecker identity (A⊗B)vec(X) = vec(BXAᵀ), we get (Z⊗K)vec(V) = vec(KVZᵀ). SS'selects only q entries. Grouping by row: O(n²r + qr).",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": 102
    },
    {
      "id": "p10-s2b",
      "node_type": "comment",
      "post_id": 1022,
      "body_text": "Adjoint map from sparse result: The sparse vector w ∈ ℝ^N maps back via (Zᵀ⊗K_tau)w = vec(K_tau W'Z) where nnz(W') = s ≤ q. W'Z: O(sr), K_tau(W'Z): O(n²r). Total: O(qr + n²r).",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": 102
    },
    {
      "id": "p10-s2c",
      "node_type": "comment",
      "post_id": 1023,
      "body_text": "Regularization term: λ(Iᵣ⊗K_tau)vec(V) = λ·vec(K_tau V). Cost: O(n²r).",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": 102
    },
    {
      "id": "p10-s2-total",
      "node_type": "comment",
      "post_id": 1024,
      "body_text": "Total per matvec: O(n²r + qr). No dependence on N. This is the central result that makes PCG feasible.",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": 102
    },
    {
      "id": "p10-s3",
      "node_type": "answer",
      "post_id": 103,
      "body_text": "Right-hand side: b = (Iᵣ⊗K_tau)vec(B) where B = TZ. T is sparse (q nonzeros), so TZ: O(qr), K_tau B: O(n²r). Total: O(qr + n²r).",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": 10
    },
    {
      "id": "p10-s4",
      "node_type": "answer",
      "post_id": 104,
      "body_text": "Preconditioner choice: after whitening by K_tau^{-1/2} and using SSᵀ ≈ cI (c=q/N), choose P = (H⊗K_tau) with H = c ZᵀZ + λIᵣ. This is a structured surrogate for A.",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": 10
    },
    {
      "id": "p10-s4-hadamard",
      "node_type": "comment",
      "post_id": 1041,
      "body_text": "Why this structure? The Khatri-Rao Hadamard property gives ZᵀZ = (A₁ᵀA₁)*(A₂ᵀA₂)*...*(Aₐᵀ Aₐ). Each Aᵢᵀ Aᵢ costs O(nᵢr²), so ZᵀZ costs O(Σᵢ nᵢr²) — vastly cheaper than O(Mr²).",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": 104
    },
    {
      "id": "p10-s4-solve",
      "node_type": "comment",
      "post_id": 1042,
      "body_text": "Preconditioner solve: P⁻¹ = H⁻¹⊗K_tau⁻¹. Precompute Cholesky of K_tau (O(n³)) and H (O(r³)). Each application solves K_tau Y Hᵀ = Z' via triangular substitution in O(n²r + nr²).",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": 104
    },
    {
      "id": "p10-s5",
      "node_type": "answer",
      "post_id": 105,
      "body_text": "Convergence: PCG has t = O(√κ log(1/ε)) with κ = cond(P^{-1/2} A P^{-1/2}). If (1-δ)P ≼ A ≼ (1+δ)P for δ in (0,1), then κ ≤ (1+δ)/(1-δ), giving a concrete fast-rate guarantee.",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": 10
    },
    {
      "id": "p10-s6",
      "node_type": "answer",
      "post_id": 106,
      "body_text": "Complexity summary: total per mode-k subproblem is O(n³ + r³ + t(n²r + qr + nr²)); for n >= r this is O(n³ + t(n²r + qr)). Compare direct O(n³r³ + Nnr). PCG removes explicit dependence on N.",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": 10
    },
    {
      "id": "p10-s7",
      "node_type": "answer",
      "post_id": 107,
      "body_text": "Algorithm: SETUP builds K_tau, H, and RHS; PCG then applies implicit MATVEC on observed entries and PRECOND_SOLVE via Kronecker factors each iteration.",
      "score": 0,
      "creation_date": "2026-02-11",
      "parent_post_id": 10
    }
  ],
  "edges": [
    {
      "source": "p10-s1",
      "target": "p10-problem",
      "edge_type": "challenge",
      "evidence": "Naive explicit direct methods incur O(Nnr) memory/work",
      "detection": "structural"
    },
    {
      "source": "p10-s2",
      "target": "p10-s1",
      "edge_type": "reform",
      "evidence": "CG only requires v ↦ Av, never the matrix A itself",
      "detection": "structural"
    },
    {
      "source": "p10-s2a",
      "target": "p10-s2",
      "edge_type": "clarify",
      "evidence": "Kronecker identity gives forward map; grouping by row avoids N",
      "detection": "structural"
    },
    {
      "source": "p10-s2b",
      "target": "p10-s2",
      "edge_type": "clarify",
      "evidence": "Sparse W' has s<=q nonzeros; adjoint via (Zᵀ⊗K_tau)",
      "detection": "structural"
    },
    {
      "source": "p10-s2c",
      "target": "p10-s2",
      "edge_type": "clarify",
      "evidence": "Regularization is just λ·vec(KV), O(n²r)",
      "detection": "structural"
    },
    {
      "source": "p10-s2-total",
      "target": "p10-s2a",
      "edge_type": "assert",
      "evidence": "Combining forward + adjoint + regularization: O(n²r + qr)",
      "detection": "structural"
    },
    {
      "source": "p10-s2-total",
      "target": "p10-s2b",
      "edge_type": "assert",
      "evidence": "Combining forward + adjoint + regularization: O(n²r + qr)",
      "detection": "structural"
    },
    {
      "source": "p10-s2-total",
      "target": "p10-s2c",
      "edge_type": "agree",
      "evidence": "Regularization absorbed into n²r term",
      "detection": "structural"
    },
    {
      "source": "p10-s3",
      "target": "p10-problem",
      "edge_type": "clarify",
      "evidence": "RHS uses sparse T and Kronecker structure, same O(qr + n²r)",
      "detection": "structural"
    },
    {
      "source": "p10-s4",
      "target": "p10-s2",
      "edge_type": "reform",
      "evidence": "Whitened surrogate motivates P = (H⊗K_tau) for faster PCG",
      "detection": "structural"
    },
    {
      "source": "p10-s4-hadamard",
      "target": "p10-s4",
      "edge_type": "clarify",
      "evidence": "Khatri-Rao Hadamard: ZᵀZ = ∏(AᵢᵀAᵢ), O(Σnᵢr²) not O(Mr²)",
      "detection": "classical"
    },
    {
      "source": "p10-s4-solve",
      "target": "p10-s4",
      "edge_type": "exemplify",
      "evidence": "P⁻¹ = H⁻¹⊗K_tau⁻¹ via Cholesky; solve cost O(n²r + nr²)",
      "detection": "structural"
    },
    {
      "source": "p10-s5",
      "target": "p10-s4",
      "edge_type": "assert",
      "evidence": "Spectral equivalence bounds κ(P⁻¹A), giving PCG rate O(√κ log(1/ε))",
      "detection": "structural"
    },
    {
      "source": "p10-s6",
      "target": "p10-problem",
      "edge_type": "assert",
      "evidence": "O(n³ + r³ + t(n²r + qr + nr²)); no explicit N-dependence",
      "detection": "structural"
    },
    {
      "source": "p10-s6",
      "target": "p10-s2-total",
      "edge_type": "reference",
      "evidence": "Matvec cost O(n²r + qr) per iteration",
      "detection": "structural"
    },
    {
      "source": "p10-s6",
      "target": "p10-s4-solve",
      "edge_type": "reference",
      "evidence": "Preconditioner solve O(n²r + nr²) per iteration",
      "detection": "structural"
    },
    {
      "source": "p10-s6",
      "target": "p10-s5",
      "edge_type": "reference",
      "evidence": "Iteration count from standard PCG bound and κ(P⁻¹A)",
      "detection": "structural"
    },
    {
      "source": "p10-s7",
      "target": "p10-s6",
      "edge_type": "exemplify",
      "evidence": "Pseudocode instantiates the complexity analysis",
      "detection": "structural"
    },
    {
      "source": "p10-s7",
      "target": "p10-s2",
      "edge_type": "reference",
      "evidence": "MATVEC subroutine implements implicit matvec",
      "detection": "structural"
    },
    {
      "source": "p10-s7",
      "target": "p10-s4-solve",
      "edge_type": "reference",
      "evidence": "PRECOND_SOLVE subroutine implements Kronecker inverse",
      "detection": "structural"
    }
  ],
  "hyperedges": [
    {
      "hx/id": "first-proof-p10:edge-000",
      "hx/type": "thread/challenge",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s1",
          "node_type": "answer"
        },
        {
          "role": "target",
          "ident": "p10-problem",
          "node_type": "question"
        }
      ],
      "hx/content": {
        "evidence": "Naive explicit direct methods incur O(Nnr) memory/work",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "challenge",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-001",
      "hx/type": "thread/reform",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s2",
          "node_type": "answer"
        },
        {
          "role": "target",
          "ident": "p10-s1",
          "node_type": "answer"
        }
      ],
      "hx/content": {
        "evidence": "CG only requires v ↦ Av, never the matrix A itself",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "reform",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-002",
      "hx/type": "thread/clarify",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s2a",
          "node_type": "comment"
        },
        {
          "role": "target",
          "ident": "p10-s2",
          "node_type": "answer"
        }
      ],
      "hx/content": {
        "evidence": "Kronecker identity gives forward map; grouping by row avoids N",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "clarify",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-003",
      "hx/type": "thread/clarify",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s2b",
          "node_type": "comment"
        },
        {
          "role": "target",
          "ident": "p10-s2",
          "node_type": "answer"
        }
      ],
      "hx/content": {
        "evidence": "Sparse W' has s<=q nonzeros; adjoint via (Zᵀ⊗K_tau)",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "clarify",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-004",
      "hx/type": "thread/clarify",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s2c",
          "node_type": "comment"
        },
        {
          "role": "target",
          "ident": "p10-s2",
          "node_type": "answer"
        }
      ],
      "hx/content": {
        "evidence": "Regularization is just λ·vec(KV), O(n²r)",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "clarify",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-005",
      "hx/type": "thread/assert",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s2-total",
          "node_type": "comment"
        },
        {
          "role": "target",
          "ident": "p10-s2a",
          "node_type": "comment"
        }
      ],
      "hx/content": {
        "evidence": "Combining forward + adjoint + regularization: O(n²r + qr)",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "assert",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-006",
      "hx/type": "thread/assert",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s2-total",
          "node_type": "comment"
        },
        {
          "role": "target",
          "ident": "p10-s2b",
          "node_type": "comment"
        }
      ],
      "hx/content": {
        "evidence": "Combining forward + adjoint + regularization: O(n²r + qr)",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "assert",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-007",
      "hx/type": "thread/agree",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s2-total",
          "node_type": "comment"
        },
        {
          "role": "target",
          "ident": "p10-s2c",
          "node_type": "comment"
        }
      ],
      "hx/content": {
        "evidence": "Regularization absorbed into n²r term",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "agree",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-008",
      "hx/type": "thread/clarify",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s3",
          "node_type": "answer"
        },
        {
          "role": "target",
          "ident": "p10-problem",
          "node_type": "question"
        }
      ],
      "hx/content": {
        "evidence": "RHS uses sparse T and Kronecker structure, same O(qr + n²r)",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "clarify",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-009",
      "hx/type": "thread/reform",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s4",
          "node_type": "answer"
        },
        {
          "role": "target",
          "ident": "p10-s2",
          "node_type": "answer"
        }
      ],
      "hx/content": {
        "evidence": "Whitened surrogate motivates P = (H⊗K_tau) for faster PCG",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "reform",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-010",
      "hx/type": "thread/clarify",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s4-hadamard",
          "node_type": "comment"
        },
        {
          "role": "target",
          "ident": "p10-s4",
          "node_type": "answer"
        }
      ],
      "hx/content": {
        "evidence": "Khatri-Rao Hadamard: ZᵀZ = ∏(AᵢᵀAᵢ), O(Σnᵢr²) not O(Mr²)",
        "detection": "classical"
      },
      "hx/labels": [
        "thread",
        "clarify",
        "classical"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-011",
      "hx/type": "thread/exemplify",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s4-solve",
          "node_type": "comment"
        },
        {
          "role": "target",
          "ident": "p10-s4",
          "node_type": "answer"
        }
      ],
      "hx/content": {
        "evidence": "P⁻¹ = H⁻¹⊗K_tau⁻¹ via Cholesky; solve cost O(n²r + nr²)",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "exemplify",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-012",
      "hx/type": "thread/assert",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s5",
          "node_type": "answer"
        },
        {
          "role": "target",
          "ident": "p10-s4",
          "node_type": "answer"
        }
      ],
      "hx/content": {
        "evidence": "Spectral equivalence bounds κ(P⁻¹A), giving PCG rate O(√κ log(1/ε))",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "assert",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-013",
      "hx/type": "thread/assert",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s6",
          "node_type": "answer"
        },
        {
          "role": "target",
          "ident": "p10-problem",
          "node_type": "question"
        }
      ],
      "hx/content": {
        "evidence": "O(n³ + r³ + t(n²r + qr + nr²)); no explicit N-dependence",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "assert",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-014",
      "hx/type": "thread/reference",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s6",
          "node_type": "answer"
        },
        {
          "role": "target",
          "ident": "p10-s2-total",
          "node_type": "comment"
        }
      ],
      "hx/content": {
        "evidence": "Matvec cost O(n²r + qr) per iteration",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "reference",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-015",
      "hx/type": "thread/reference",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s6",
          "node_type": "answer"
        },
        {
          "role": "target",
          "ident": "p10-s4-solve",
          "node_type": "comment"
        }
      ],
      "hx/content": {
        "evidence": "Preconditioner solve O(n²r + nr²) per iteration",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "reference",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-016",
      "hx/type": "thread/reference",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s6",
          "node_type": "answer"
        },
        {
          "role": "target",
          "ident": "p10-s5",
          "node_type": "answer"
        }
      ],
      "hx/content": {
        "evidence": "Iteration count from standard PCG bound and κ(P⁻¹A)",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "reference",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-017",
      "hx/type": "thread/exemplify",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s7",
          "node_type": "answer"
        },
        {
          "role": "target",
          "ident": "p10-s6",
          "node_type": "answer"
        }
      ],
      "hx/content": {
        "evidence": "Pseudocode instantiates the complexity analysis",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "exemplify",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-018",
      "hx/type": "thread/reference",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s7",
          "node_type": "answer"
        },
        {
          "role": "target",
          "ident": "p10-s2",
          "node_type": "answer"
        }
      ],
      "hx/content": {
        "evidence": "MATVEC subroutine implements implicit matvec",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "reference",
        "structural"
      ]
    },
    {
      "hx/id": "first-proof-p10:edge-019",
      "hx/type": "thread/reference",
      "hx/ends": [
        {
          "role": "source",
          "ident": "p10-s7",
          "node_type": "answer"
        },
        {
          "role": "target",
          "ident": "p10-s4-solve",
          "node_type": "comment"
        }
      ],
      "hx/content": {
        "evidence": "PRECOND_SOLVE subroutine implements Kronecker inverse",
        "detection": "structural"
      },
      "hx/labels": [
        "thread",
        "reference",
        "structural"
      ]
    }
  ],
  "stats": {
    "n_nodes": 14,
    "n_edges": 20,
    "node_types": {
      "question": 1,
      "answer": 7,
      "comment": 6
    },
    "edge_types": {
      "challenge": 1,
      "reform": 2,
      "clarify": 5,
      "assert": 4,
      "agree": 1,
      "exemplify": 2,
      "reference": 5
    },
    "detection_types": {
      "structural": 19,
      "classical": 1
    }
  }
}