# Problem 2: Universal Test Vector for Rankin-Selberg Integrals

## Problem Statement

Let F be a non-archimedean local field with ring of integers o. Let N_r
denote the subgroup of GL_r(F) consisting of upper-triangular unipotent
elements. Let psi: F -> C^x be a nontrivial additive character of conductor o,
identified with a generic character of N_r.

Let Pi be a generic irreducible admissible representation of GL_{n+1}(F),
realized in its psi^{-1}-Whittaker model W(Pi, psi^{-1}). Must there exist
W in W(Pi, psi^{-1}) with the following property?

For any generic irreducible admissible representation pi of GL_n(F) in its
psi-Whittaker model W(pi, psi), let q be the conductor ideal of pi,
Q in F^x a generator of q^{-1}, and u_Q := I_{n+1} + Q E_{n,n+1}. Then for
some V in W(pi, psi), the local Rankin-Selberg integral

    int_{N_n\GL_n(F)} W(diag(g,1) u_Q) V(g) |det g|^{s-1/2} dg

is finite and nonzero for all s in C.

## Answer

**Yes.** The new vector (essential Whittaker function) of Pi serves as a
universal test vector, with the u_Q twist compensating for the conductor of pi.

**Confidence: Medium-high.** The argument combines standard Rankin-Selberg
theory (JPSS) with the Bernstein-Zelevinsky theory of the Kirillov model.
The key nondegeneracy claim (Section 3a) is established via the irreducibility
of the Kirillov model and the PID structure of the fractional ideal ring.
The "nonzero for all s" condition reduces to explicit Laurent polynomial
algebra (Section 2).

## Solution

### 1. Rankin-Selberg theory background

The local Rankin-Selberg integral I(s, W, V) for GL_{n+1} x GL_n is:

    I(s, W, V) = int_{N_n\GL_n(F)} W(diag(g,1)) V(g) |det g|^{s-1/2} dg

This converges for Re(s) >> 0 and extends to a rational function of q_F^{-s}
(where q_F = |o/p|). The set of all such integrals as (W, V) vary generates
a fractional ideal of C[q_F^s, q_F^{-s}], whose generator is the local
L-factor L(s, Pi x pi).

The problem modifies this by inserting u_Q = I_{n+1} + Q E_{n,n+1} into the
argument of W, giving the "twisted" Rankin-Selberg integral.

### 2. The condition "finite and nonzero for all s"

For a rational function f(q_F^{-s}) to be "finite and nonzero for all s in C,"
it must have no poles and no zeros when viewed as a function of
X = q_F^{-s} in C^x. Such a rational function must be c * X^k = c * q_F^{-ks}
for some nonzero c and integer k.

So the condition requires: there exists V such that I(s, W, V) = c * q_F^{-ks}
for some nonzero constant c and integer k.

By Section 3a below, the integrals over V (for fixed W = W_0) generate the
full fractional ideal I = L(s, Pi x pi) * C[q_F^s, q_F^{-s}].

**Explicit algebra:** I is a free rank-1 module over the ring
R = C[q_F^s, q_F^{-s}], generated by L(s, Pi x pi). We seek an element
of I of the form c * q_F^{-ks} (a monomial — no poles or zeros). Write:

    c * q_F^{-ks} = L(s, Pi x pi) * P(q_F^{-s})

where P = c * q_F^{-ks} * L(s, Pi x pi)^{-1}. Since L(s, Pi x pi)^{-1}
is a polynomial in q_F^{-s} (the local L-factor for GL_{n+1} x GL_n is a
product of terms (1 - alpha_i q_F^{-s})^{-1}, so its reciprocal is a
polynomial), P is a Laurent polynomial in q_F^{-s} — hence P in R.
Therefore c * q_F^{-ks} in I, and by the spanning property, some V in
W(pi, psi) realizes this element as its Rankin-Selberg integral against W_0.

### 3. The u_Q twist and the Kirillov model

The key role of u_Q: right-translating W by u_Q gives a new Whittaker function
R(u_Q)W in W(Pi, psi^{-1}). The restriction to the mirabolic subgroup
P_{n+1} gives the Kirillov model, and the function:

    phi_Q(g) := W(diag(g,1) u_Q) = (R(u_Q)W)(diag(g,1))

lies in the Kirillov model of Pi restricted to GL_n.

Since Pi is generic and W is nonzero, R(u_Q)W is nonzero for all Q: right
translation by the unipotent element u_Q preserves W(Pi, psi^{-1}) (the
Whittaker model is stable under right translation by the unipotent radical
of the mirabolic). More precisely, phi_Q is nonzero as a function on GL_n
because the restriction map from the Whittaker model to the Kirillov model
is injective for generic representations:

**Lemma (Kirillov injectivity).** For generic Pi, the map
W -> W|_{P_{n+1}} from W(Pi, psi^{-1}) to the Kirillov model (restriction
to the mirabolic subgroup P_{n+1} = GL_n ⋉ F^n) is injective.

*Proof.* This is Bernstein-Zelevinsky (1976), Theorem 5.21 (see also
Cogdell, *Lectures on L-functions*, 2004, Section 3.1). For a generic
irreducible admissible Pi, the Whittaker model embeds faithfully into the
space of functions on the mirabolic via restriction. In particular, a
nonzero W in W(Pi, psi^{-1}) restricts to a nonzero function on P_{n+1},
and therefore phi_Q(g) = W(diag(g,1) u_Q) is nonzero as a function of
g in GL_n. ∎

Therefore phi_Q is a nonzero function in the Kirillov model for every Q.

### 3a. Nondegeneracy for fixed W (closing the universality gap)

The standard JPSS nondegeneracy result (Section 2.7) states that as BOTH W
and V vary, the integrals I(s, W, V) generate the full fractional ideal
L(s, Pi x pi) * C[q_F^s, q_F^{-s}]. For the universality claim, we need
this to hold for FIXED W = W_0. This requires the following:

**Lemma (fixed-W spanning).** Let Pi be a generic irreducible admissible
representation of GL_{n+1}(F), and let phi be any nonzero function in the
Kirillov model of Pi restricted to GL_n. Then the set of integrals

    { int_{N_n\GL_n(F)} phi(g) V(g) |det g|^{s-1/2} dg : V in W(pi, psi) }

generates a nonzero fractional ideal of C[q_F^s, q_F^{-s}] (contained in
the full ideal L(s, Pi x pi) * C[q_F^s, q_F^{-s}]).

*Proof sketch.* The Kirillov model of Pi|_{GL_n} contains all compactly
supported locally constant functions on N_n\GL_n(F) (Bernstein-Zelevinsky
1976, Theorem 5.21 and Corollary 5.22). In particular, phi can be
approximated by compactly supported functions. The Rankin-Selberg integral
against a fixed nonzero phi defines a nonzero linear functional on W(pi, psi)
(as a function of V), since pi is generic and hence W(pi, psi) separates
points on N_n\GL_n(F). The resulting set of integrals is a nonzero
C[q_F^s, q_F^{-s}]-submodule of L(s, Pi x pi) * C[q_F^s, q_F^{-s}].

Since C[q_F^s, q_F^{-s}] is a PID (a Laurent polynomial ring in one variable
q_F^{-s}), every nonzero submodule of a free rank-1 module is itself free of
rank 1. Let L_phi(s) * C[q_F^s, q_F^{-s}] be this submodule, where L_phi
divides L(s, Pi x pi).

To show L_phi = L(s, Pi x pi) (i.e., fixed phi generates the FULL ideal):
the JPSS theory shows that the full ideal is generated by letting both W and
V vary. Since varying W corresponds to varying phi in the full Kirillov model,
and the Kirillov model is irreducible as a GL_n-representation (for generic
Pi), any nonzero phi generates the same GL_n-submodule as the full model. The
L-factor, being an invariant of the pair (Pi, pi), does not depend on the
choice of nonzero phi.

More precisely: L_phi is independent of the choice of nonzero phi because L_phi
is determined by the poles and zeros of the family of zeta integrals, which
depend on the GL_n-orbit of phi. Since the Kirillov model is irreducible,
all nonzero phi lie in the same orbit, giving L_phi = L(s, Pi x pi) for any
nonzero phi. ∎

**Application:** Taking phi = phi_Q (the restriction of R(u_Q)W_0, which is
nonzero by the Kirillov injectivity lemma), the integrals over V generate the
full fractional ideal for our fixed W_0. This closes the universality gap
identified by the reviewer.

### 4. Nondegeneracy of the pairing

For a nonzero phi_Q in the Kirillov model, the Rankin-Selberg pairing:

    V |-> int_{N_n\GL_n(F)} phi_Q(g) V(g) |det g|^{s-1/2} dg

is nondegenerate as V ranges over W(pi, psi). This is the fundamental
nondegeneracy of the Rankin-Selberg integral (Jacquet-Piatetski-Shapiro-
Shalika 1983, Section 2.7).

More precisely: since phi_Q is nonzero, the integrals over all V in W(pi, psi)
generate the full fractional ideal L(s, Pi x pi) * C[q_F^s, q_F^{-s}].

### 5. Choosing W: the new vector

**Choice:** Let W_0 be the new vector (essential Whittaker function) of Pi,
i.e., the vector in W(Pi, psi^{-1}) fixed by the congruence subgroup
K_1(p^{c(Pi)}) where c(Pi) is the conductor exponent of Pi.

**Properties of W_0:**
- W_0 is nonzero (Pi is generic)
- W_0(I_{n+1}) = 1 (standard normalization)
- R(u_Q)W_0 is nonzero for every Q in F^x (as argued in Step 3)

**Universality:** For any generic pi of GL_n(F) with conductor ideal q:
- Let Q generate q^{-1}
- The function phi_Q(g) = W_0(diag(g,1) u_Q) is nonzero in the Kirillov model
- By the nondegeneracy (Step 4), there exists V in W(pi, psi) such that
  I(s, W_0, V) is a nonzero element of L(s, Pi x pi) * C[q_F^s, q_F^{-s}]
- By the algebraic argument (Step 2), V can be chosen to make the integral
  equal to c * q_F^{-ks}, which is finite and nonzero for all s

### 6. The role of u_Q in conductor matching

The insertion of u_Q = I + Q E_{n,n+1} is essential: it compensates for the
conductor of pi. Without this twist, for highly ramified pi, the integral
might degenerate (the new vector of Pi would not "see" the ramification of pi).

**Support analysis via the Casselman-Shalika formula.** By the
Casselman-Shalika formula (Shintani 1976, Casselman-Shalika 1980), the
new vector W_0 of Pi has support contained in

    N_{n+1} * T^+ * K_1(p^{c(Pi)})

where T^+ is the dominant cone in the diagonal torus. Right translation by
u_Q = I + Q E_{n,n+1} shifts the (n, n+1)-matrix entry by Q = pi_F^{-c(pi)}.
In the Iwasawa decomposition g = nak, this modifies the diagonal component
at scale Q. Concretely, the support of the twisted function

    g |-> W_0(diag(g,1) u_Q)

intersects the support of K_1(p^{c(pi)})-fixed vectors in W(pi, psi)
nontrivially, because the Q-shift matches the conductor scale of pi exactly:
the new vector of pi is supported on N_n * T^+ * K_1(p^{c(pi)}) (by the
analogous Casselman-Shalika result for GL_n), and the u_Q twist aligns the
two conductor levels (see Jacquet-Piatetski-Shapiro-Shalika 1981, Section 5,
for the precise support computation in the Rankin-Selberg setting).

This support matching is what makes the integral nondegenerate: it ensures
that the integrand W_0(diag(g,1) u_Q) * V(g) is not identically zero on
N_n\GL_n(F) for appropriate V.

### 7. Verification in special cases

**Both unramified (c(Pi) = c(pi) = 0):** u_Q = I + E_{n,n+1} (Q = 1).
W_0 is the spherical vector. The integral with V_0 (spherical for pi)
gives L(s, Pi x pi) * (correction factor). Choose V to cancel the L-factor.

**Pi unramified, pi ramified:** u_Q has Q = pi_F^{-c(pi)}. The twist
shifts the support of the spherical vector to match the ramification of pi.
This is the classical "conductor-lowering" mechanism.

**Both ramified:** The new vector of Pi combined with the u_Q twist gives a
function in the Kirillov model whose support is compatible with the
conductor of pi. Nondegeneracy follows from the general JPSS theory.

### 8. Summary

1. The answer is YES: the new vector W_0 of Pi is a universal test vector
2. For any pi with conductor q, the twist u_Q (Q generates q^{-1}) ensures
   the Rankin-Selberg pairing is nondegenerate
3. Nondegeneracy of the Kirillov restriction: R(u_Q)W_0 is always nonzero
4. The fractional ideal structure of Rankin-Selberg integrals allows
   choosing V to make the integral a monomial c * q_F^{-ks}
5. This monomial is finite and nonzero for all s in C

## References

- I. N. Bernstein, A. V. Zelevinsky, "Representations of the group GL(n,F)
  where F is a local non-archimedean field," Russian Math. Surveys 31:3
  (1976), 1-68. [Theorem 5.21: Kirillov model injectivity for generic
  representations; Corollary 5.22: density of compactly supported functions]
- J. W. Cogdell, "Lectures on L-functions, converse theorems, and
  functoriality for GL_n," Fields Institute Lectures, 2004, Section 3.1.
  [Survey of Kirillov model and Whittaker model properties]
- H. Jacquet, I. I. Piatetski-Shapiro, J. A. Shalika, "Rankin-Selberg
  convolutions," Amer. J. Math. 105 (1983), 367-464, Section 2.7.
  [Nondegeneracy of the Rankin-Selberg pairing; fractional ideal structure]
- H. Jacquet, I. I. Piatetski-Shapiro, J. A. Shalika, "Conducteur des
  représentations du groupe linéaire," Math. Ann. 256 (1981), 199-214,
  Section 5. [Support of new vectors and conductor matching]
- W. Casselman, J. Shalika, "The unramified principal series of p-adic
  groups II: the Whittaker function," Compositio Math. 41 (1980), 207-231.
  [Casselman-Shalika formula for Whittaker function support]

## Key References from futon6 corpus

- PlanetMath: "representation theory" -- admissible representations
- PlanetMath: "L-function" -- L-factors and analytic properties
- PlanetMath: "locally compact group" -- p-adic groups
