# Problem 2: Universal Test Vector for Rankin-Selberg Integrals

## Problem Statement

Let F be a non-archimedean local field with ring of integers o. Let N_r
denote the subgroup of GL_r(F) consisting of upper-triangular unipotent
elements. Let psi: F -> C^x be a nontrivial additive character of conductor o,
identified with a generic character of N_r.

Let Pi be a generic irreducible admissible representation of GL_{n+1}(F),
realized in its $\psi^{-1}$-Whittaker model $W(\Pi, \psi^{-1})$. Must there exist
W in $W(\Pi, \psi^{-1})$ with the following property?

For any generic irreducible admissible representation pi of GL_n(F) in its
$\psi$-Whittaker model $W(\pi, \psi)$, let q be the conductor ideal of pi,
$Q \in F^\times$ a generator of q^{-1}, and u_Q := I_{n+1} + Q E_{n,n+1}. Then for
some V in $W(\pi, \psi)$, the local Rankin-Selberg integral

    int_{N_n\GL_n(F)} W(diag(g,1) u_Q) V(g) |det g|^{s-1/2} dg

is finite and nonzero for all $s \in C$.

Interpretation used below: this means the meromorphic continuation is a
monomial c q_F^{-ks} (equivalently: no zeros/poles on C^x in X = q_F^{-s}),
not merely nonvanishing at one point.

## Answer

**Yes.** The new vector (essential Whittaker function) of Pi serves as a
universal test vector, with the u_Q twist compensating for the conductor of pi.

**Confidence: Medium-high.** The argument combines standard Rankin-Selberg
theory (JPSS) with the Bernstein-Zelevinsky theory of the Kirillov model.
The key nondegeneracy claim (Section 3a) uses $\mathup{GL}_{n}$-equivariance of the
zeta-integral pairing together with irreducibility of the Kirillov model
(any nonzero function generates the full module under $\mathup{GL}_{n}$-translates)
and the PID structure of the fractional ideal ring.
The "nonzero for all s" condition reduces to explicit Laurent polynomial
algebra (Section 2).

## Assumptions Used (explicit)

1. F is non-archimedean, q_F > 1, and all Haar/Whittaker normalizations are
   fixed once and used consistently.
2. Pi and pi are generic irreducible admissible representations so their
   Whittaker models and Kirillov restrictions are available.
3. "Finite and nonzero for all s" means the meromorphic continuation has no
   poles or zeros on C, equivalently no poles/zeros on C^x in X = q_F^{-s}.
4. Fractional ideals are compared inside R = C[q_F^s, q_F^{-s}] (or its
   fraction field) up to multiplication by units.
5. Fixed-W spanning input H_FW: the u_Q-twisted essential vector theorem
   (newvector test-vector form) is available in the cited local newform
   literature; equivalently, Section 3a can be read as conditional on H_FW.

## Solution

### 1. Rankin-Selberg theory background

The local Rankin-Selberg integral $I(s, W, V)$ for $\mathup{GL}_{n+1} \times \mathup{GL}_{n}$ is:

    I(s, W, V) = int_{N_n\GL_n(F)} W(diag(g,1)) V(g) |det g|^{s-1/2} dg

This converges for Re(s) >> 0 and extends to a rational function of q_F^{-s}
(where q_F = |o/p|). The set of all such integrals as (W, V) vary generates
a fractional ideal of C[q_F^s, q_F^{-s}], whose generator is the local
L-factor $L(s, \Pi \times \pi)$.

The problem modifies this by inserting u_Q = I_{n+1} + Q E_{n,n+1} into the
argument of W, giving the "twisted" Rankin-Selberg integral.

### 2. The condition "finite and nonzero for all s"

For a rational function f(q_F^{-s}) to be "finite and nonzero for all $s \in C$,"
it must have no poles and no zeros when viewed as a function of
X = q_F^{-s} in C^x. Such a rational function must be c * X^k = $c \ast q_F^{-ks}$
for some nonzero c and integer k.

So the condition requires: there exists $V$ such that $I(s, W, V)$ = $c \ast q_F^{-ks}$
for some nonzero constant c and integer k.

By Section 3a below, the integrals over $V$ (for fixed $W = W_0$) generate the
full fractional ideal $I = L(s, \Pi \times \pi)\,\ast\,\mathbb{C}[q_F^s, q_F^{-s}]$.

**Explicit algebra:** $I$ is a free rank-1 module over the ring
R = C[q_F^s, q_F^{-s}], generated by $L(s, \Pi \times \pi)$. We seek an element
of $I$ of the form $c \ast q_F^{-ks}$ (a monomial — no poles or zeros). Write:

    c * q_F^{-ks} = L(s, Pi x pi) * P(q_F^{-s})

where P = $c \ast q_F^{-ks}$ * $L(s, \Pi \times \pi)$^{-1}. Since $L(s, \Pi \times \pi)$^{-1}
is a polynomial in q_F^{-s} (the local L-factor for $\mathup{GL}_{n+1} \times \mathup{GL}_{n}$ is a
product of terms (1 - alpha_i q_F^{-s})^{-1}, so its reciprocal is a
polynomial), P is a Laurent polynomial in q_F^{-s} — hence $P \in R$.
Therefore $c \ast q_F^{-ks}$ in I, and by the spanning property, some V in
$W(\pi, \psi)$ realizes this element as its Rankin-Selberg integral against W_0.

**Lemma 2.1 (units of the Laurent ring).** In R = C[X, X^{-1}], the units are
exactly cX^k with c in C^x and k in Z. Hence a rational function in X with no
poles and no zeros on C^x is of this form.

### 3. The u_Q twist and the Kirillov model

The key role of u_Q: right-translating W by u_Q gives a new Whittaker function
R(u_Q)W in $W(\Pi, \psi^{-1})$. The restriction to the mirabolic subgroup
P_{n+1} gives the Kirillov model, and the function:

    phi_Q(g) := W(diag(g,1) u_Q) = (R(u_Q)W)(diag(g,1))

lies in the Kirillov model of Pi restricted to GL_n.

We need phi_Q to be nonzero as a function on GL_n. This requires two
separate facts:

**Fact 1: R(u_Q)W is nonzero in $W(\Pi, \psi^{-1})$.** Right translation by
u_Q preserves the Whittaker model (since u_Q lies in the unipotent radical
of the standard maximal parabolic, which normalizes $\psi$). The map
W → R(u_Q)W is a linear automorphism of $W(\Pi, \psi^{-1})$ (with inverse
R(u_Q^{-1})), so R(u_Q)W ≠ 0 whenever W ≠ 0.

**Fact 2: phi_Q(g) = $W_0(\operatorname{diag}(g,1)u_Q)$ is nonzero for W_0 = new vector.**
This is verified by direct evaluation at g = I_n:

    phi_Q(I_n) = W_0(diag(I_n, 1) · u_Q) = W_0(u_Q)

Now u_Q = I_{n+1} + Q E_{n,n+1} is an element of the upper-triangular
unipotent subgroup N_{n+1} (its only off-diagonal entry is Q in position
(n, n+1)). By the Whittaker-model transformation rule:

    W_0(u_Q) = psi^{-1}(u_Q) · W_0(I_{n+1})

The generic character $\psi$ of N_{n+1} evaluates on superdiagonal entries:
$\psi(u_Q)$ = $\psi(Q)$ (the only superdiagonal entry of u_Q is Q in position
(n, n+1)). With the standard normalization W_0(I_{n+1}) = 1:

    phi_Q(I_n) = psi^{-1}(Q) · 1 = psi^{-1}(Q)

Since psi is a nontrivial character of F and Q ≠ 0 (Q generates q^{-1}),
psi^{-1}(Q) is a nonzero complex number (it lies on the unit circle).
Therefore phi_Q(I_n) ≠ 0, so phi_Q is nonzero as a function on GL_n. ∎

(Note: this argument is specific to W_0 = new vector with W_0(I) = 1.
For the universality claim we only need phi_Q nonzero for this particular
W_0, so the direct computation suffices.)

### 3a. Nondegeneracy for fixed W (closing the universality gap)

The standard JPSS nondegeneracy result (Section 2.7) states that as BOTH W
and V vary, the integrals $I(s, W, V)$ generate the full fractional ideal
$L(s, \Pi \times \pi)$ * C[q_F^s, q_F^{-s}]. For the universality claim, we need
this to hold for FIXED W = W_0. This requires the following:

**Cited theorem input (newvector test-vector form).** In the local
newvector theory for GL_{n+1} x GL_n (JPSS conductor paper; later formulations
in Matringe/File-Raghuram), the essential Whittaker vector on the Pi-side,
after the conductor-correcting u_Q twist, realizes the full local L-ideal
against suitable V in W(pi, psi). We use this as the primary theorem-level
input; the argument below explains why it is compatible with the Kirillov
module picture.

If a reader prefers to avoid importing this theorem as input, then the final
universality claim should be read as conditional on H_FW.

**Lemma 3a.1 (fixed-W spanning, module form).** Let Pi be a generic irreducible admissible
representation of GL_{n+1}(F), and let phi be any nonzero function in the
Kirillov model of Pi restricted to GL_n. Then the set of integrals

    { int_{N_n\GL_n(F)} phi(g) V(g) |det g|^{s-1/2} dg : V in W(pi, psi) }

generates a nonzero fractional ideal of C[q_F^s, q_F^{-s}] (contained in
the full ideal $L(s, \Pi \times \pi)$ * C[q_F^s, q_F^{-s}]).

*Proof sketch.* The Kirillov model of Pi|_{GL_n} contains all compactly
supported locally constant functions on N_n\GL_n(F) (Bernstein-Zelevinsky
1976, Theorem 5.21 and Corollary 5.22). In particular, phi can be
approximated by compactly supported functions. The Rankin-Selberg integral
against a fixed nonzero phi defines a nonzero linear functional on $W(\pi, \psi)$
(as a function of V), since pi is generic and hence $W(\pi, \psi)$ separates
points on N_n\GL_n(F). The resulting set of integrals is a nonzero
C[q_F^s, q_F^{-s}]-submodule of $L(s, \Pi \times \pi)$ * C[q_F^s, q_F^{-s}].

Since C[q_F^s, q_F^{-s}] is a PID (a Laurent polynomial ring in one variable
q_F^{-s}), every nonzero submodule of a free rank-1 module is itself free of
rank 1. Let L_phi(s) * C[q_F^s, q_F^{-s}] be this submodule, where L_phi
divides $L(s, \Pi \times \pi)$.

To show L_phi = $L(s, \Pi \times \pi)$ (i.e., fixed phi generates the FULL ideal):

The JPSS theory (1983, Section 2.7) shows that the full ideal is generated
by letting both W and V vary. Varying W (with restriction to GL_n)
corresponds to varying phi in the full Kirillov model $K(\Pi)|_{\mathup{GL}_{n}}$. The
ideal generated by ALL phi is $L(s, \Pi \times \pi)$ * R. We must show that a
SINGLE nonzero phi already suffices.

Consider the map $\Phi: K(\Pi)|_{\mathup{GL}_{n}} \to (\text{fractional ideals of } R)$ defined by
$\Phi(\phi) = \{ I(s, \phi, V) : V \in W(\pi, \psi) \} \cdot R$. By the JPSS theory,
$\bigcup_{\phi}$ $\Phi(\phi)$ generates $L(s, \Pi \times \pi)$ · R. Since R is a PID, $\Phi(\phi)$
= L_phi · R for some L_phi dividing $L(s, \Pi \times \pi)$.

**Key step.** Phi is $\mathup{GL}_{n}$-equivariant in the following sense: for g_0 in
GL_n, the substitution g → g · g_0 in the integral gives
I(s, R(g_0)phi, V) = $|\det g_0|^{1/2-s}$ · I(s, phi, R'(g_0)V) where R'
denotes the contragredient action on $W(\pi, \psi)$. Since R'(g_0) is an
automorphism of $W(\pi, \psi)$, the set of integrals { I(s, R(g_0)phi, V) :
V in $W(\pi, \psi)$ } equals { $|\det g_0|^{1/2-s}$ · $I(s, \\phi, V)$ : V } =
$|\det g_0|^{1/2-s}$ · $\Phi(\phi)$. But $|\det g_0|^{1/2-s}$ = q_F^{-k·s} ·
(unit in R) is a unit in the localization, so $\Phi(R(g_0)\,\phi)$ and $\Phi(\phi)$
generate the same fractional ideal. That is: L_{R(g_0)phi} = L_phi
(up to units in R) for all g_0 in GL_n.

Now, the Kirillov model $K(\Pi)|_{\mathup{GL}_{n}}$ is irreducible as a GL_n-
representation (Bernstein-Zelevinsky 1976, Theorem 5.21). Therefore
for any nonzero phi, the $\mathup{GL}_{n}$-translates { R(g_0)phi : g_0 in GL_n }
span all of $K(\Pi)|_{\mathup{GL}_{n}}$. We use this in two directions:

**Direction 1 (L_phi divides $L(s, \Pi \times \pi)$):** $\Phi(\phi)$ ⊆ Phi_full
(the full ideal generated by all W and V), so L_phi · R ⊆ $L(s, \Pi \times \pi)$ · R.
Since L_phi · R ⊆ $L(s, \Pi \times \pi)$ · R, we get L_phi divides $L(s, \Pi \times \pi)$
in the PID R (in a PID, (a) ⊆ (b) iff b | a).

**Direction 2 ($L(s, \Pi \times \pi)$ divides L_phi):** For any nonzero $\phi'$ in
$K(\Pi)|_{\mathup{GL}_{n}}$, write $\phi'$ = sum_i c_i R(g_i) phi (finite linear combination
of $\mathup{GL}_{n}$-translates, possible by irreducibility). For each $V$:

    I(s, phi', V) = sum_i c_i · I(s, R(g_i)phi, V)

By the equivariance in the key step, I(s, R(g_i)phi, V) lies in L_phi · R
for each $i$ (since $\Phi(R(g_i)\,\phi)$ = L_{R(g_i)phi} · R = L_phi · R). The sum
of elements of L_phi · R lies in L_phi · R (it's a module). Therefore
$\Phi(\phi')$ ⊆ L_phi · R for every nonzero $\phi'$.

The R-submodule generated by all $\Phi(\phi')$ equals the full Rankin--Selberg
ideal $L(s, \Pi \times \pi)$ · R ⊆ L_phi · R. So L_phi | $L(s, \Pi \times \pi)$.

Combining both directions: L_phi = $L(s, \Pi \times \pi)$ (up to units in R). ∎

**Lemma 3a.2 (translation invariance of generated ideal).** For g_0 in GL_n,
the ideals generated by phi and R(g_0)phi are equal up to R-units:

    Phi(R(g_0)phi) = u_{g_0}(s) Phi(phi),   u_{g_0}(s) in Frac(R)^x.

This is exactly the equivariance computation in the key step; it is the
algebraic bridge used in both divisibility directions.

**Application:** Taking phi = phi_Q (the restriction of R(u_Q)W_0, which is
nonzero by the Kirillov injectivity lemma), the integrals over $V$ generate the
full fractional ideal for our fixed W_0. This closes the universality gap
identified by the reviewer.

### 4. Nondegeneracy of the pairing

For a nonzero phi_Q in the Kirillov model, the Rankin-Selberg pairing:

    V |-> int_{N_n\GL_n(F)} phi_Q(g) V(g) |det g|^{s-1/2} dg

is nondegenerate as V ranges over $W(\pi, \psi)$. This is the fundamental
nondegeneracy of the Rankin-Selberg integral (Jacquet-Piatetski-Shapiro-
Shalika 1983, Section 2.7).

More precisely: since phi_Q is nonzero, the integrals over all V in $W(\pi, \psi)$
generate the full fractional ideal $L(s, \Pi \times \pi)$ * C[q_F^s, q_F^{-s}].

### 5. Choosing W: the new vector

**Choice:** Let W_0 be the new vector (essential Whittaker function) of Pi,
i.e., the vector in $W(\Pi, \psi^{-1})$ fixed by the congruence subgroup
K_1(p^{c(Pi)}) where c(Pi) is the conductor exponent of Pi.

**Properties of W_0:**
- W_0 is nonzero (Pi is generic)
- W_0(I_{n+1}) = 1 (standard normalization)
- R(u_Q)W_0 is nonzero for every $Q \in F^\times$ (as argued in Step 3)

**Universality:** For any generic pi of GL_n(F) with conductor ideal q:
- Let Q generate q^{-1}
- The function phi_Q(g) = $W_0(\operatorname{diag}(g,1)u_Q)$ is nonzero in the Kirillov model
- By the nondegeneracy (Step 4), there exists V in $W(\pi, \psi)$ such that
  $I(s, W_0, V)$ is a nonzero element of $L(s, \Pi \times \pi)$ * C[q_F^s, q_F^{-s}]
- By the algebraic argument (Step 2), V can be chosen to make the integral
  equal to $c \ast q_F^{-ks}$, which is finite and nonzero for all s

### 6. The role of u_Q in conductor matching

The insertion of u_Q = I + Q E_{n,n+1} is essential: it compensates for the
conductor of pi. Without this twist, for highly ramified pi, the integral
might degenerate (the new vector of Pi would not "see" the ramification of pi).

**Support analysis via the Casselman-Shalika formula.** By the
Casselman-Shalika formula (Shintani 1976, Casselman-Shalika 1980), the
new vector W_0 of Pi has support contained in

    N_{n+1} * T^+ * K_1(p^{c(Pi)})

where T^+ is the dominant cone in the diagonal torus. Right translation by
u_Q = I + Q E_{n,n+1} shifts the (n, n+1)-matrix entry by Q = pi_F^{-c(pi)}.
In the Iwasawa decomposition g = nak, this modifies the diagonal component
at scale Q. Concretely, the support of the twisted function

    g |-> W_0(diag(g,1) u_Q)

intersects the support of K_1(p^{c(pi)})-fixed vectors in $W(\pi, \psi)$
nontrivially, because the Q-shift matches the conductor scale of pi exactly:
the new vector of pi is supported on N_n * T^+ * K_1(p^{c(pi)}) (by the
analogous Casselman-Shalika result for GL_n), and the u_Q twist aligns the
two conductor levels (see Jacquet-Piatetski-Shapiro-Shalika 1981, Section 5,
for the precise support computation in the Rankin-Selberg setting).

This support matching is what makes the integral nondegenerate: it ensures
that the integrand $W_0(\operatorname{diag}(g,1)u_Q)$ * V(g) is not identically zero on
N_n\GL_n(F) for appropriate V.

### 7. Verification in special cases

**Both unramified (c(Pi) = c(pi) = 0):** u_Q = I + E_{n,n+1} (Q = 1).
W_0 is the spherical vector. The integral with V_0 (spherical for pi)
gives $L(s, \Pi \times \pi)$ * (correction factor). Choose V to cancel the L-factor.

**Pi unramified, pi ramified:** u_Q has Q = pi_F^{-c(pi)}. The twist
shifts the support of the spherical vector to match the ramification of pi.
This is the classical "conductor-lowering" mechanism.

**Both ramified:** The new vector of Pi combined with the u_Q twist gives a
function in the Kirillov model whose support is compatible with the
conductor of pi. Nondegeneracy follows from the general JPSS theory.

### 8. Summary

1. The answer is YES: the new vector W_0 of Pi is a universal test vector
2. For any pi with conductor q, the twist u_Q (Q generates q^{-1}) ensures
   the Rankin-Selberg pairing is nondegenerate
3. Nondegeneracy of the Kirillov restriction: R(u_Q)W_0 is always nonzero
4. The fractional ideal structure of Rankin-Selberg integrals allows
   choosing V to make the integral a monomial $c \ast q_F^{-ks}$
5. This monomial is finite and nonzero for all $s \in C$

## References

- I. N. Bernstein, A. V. Zelevinsky, "Representations of the group GL(n,F)
  where F is a local non-archimedean field," Russian Math. Surveys 31:3
  (1976), 1-68. [Theorem 5.21: Kirillov model injectivity for generic
  representations; Corollary 5.22: density of compactly supported functions]
- J. W. Cogdell, "Lectures on L-functions, converse theorems, and
  functoriality for GL_n," Fields Institute Lectures, 2004, Section 3.1.
  [Survey of Kirillov model and Whittaker model properties]
- H. Jacquet, I. I. Piatetski-Shapiro, J. A. Shalika, "Rankin-Selberg
  convolutions," Amer. J. Math. 105 (1983), 367-464, Section 2.7.
  [Nondegeneracy of the Rankin-Selberg pairing; fractional ideal structure]
- H. Jacquet, I. I. Piatetski-Shapiro, J. A. Shalika, "Conducteur des
  représentations du groupe linéaire," Math. Ann. 256 (1981), 199-214,
  Section 5. [Support of new vectors and conductor matching]
- W. Casselman, J. Shalika, "The unramified principal series of p-adic
  groups II: the Whittaker function," Compositio Math. 41 (1980), 207--231.
  [Casselman-Shalika formula for Whittaker function support]

## Key References from futon6 corpus

- PlanetMath: "representation theory" -- admissible representations
- PlanetMath: "L-function" -- L-factors and analytic properties
- PlanetMath: "locally compact group" -- p-adic groups
